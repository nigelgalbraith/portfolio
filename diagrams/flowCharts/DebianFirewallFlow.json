{
  "nodes": {
    "Setup": { "label": "Setup logging and load firewall config" },
    "ShowRules": { "label": "Display firewall rules for review" },
    "UserConfirm": { "label": "Confirm before applying changes" },
    "ApplyRules": { "label": "Reset UFW and apply rules" },
    "Reload": { "label": "Reload UFW and show status" },
    "Finish": { "label": "Rotate logs and finish" }
  },
  "connections": [
    ["Setup", "ShowRules"],
    ["ShowRules", "UserConfirm"],
    ["UserConfirm", "ApplyRules"],
    ["ApplyRules", "Reload"],
    ["Reload", "Finish"]
  ],
  "classes": {
    "step": "fillcolor:#e6f4ea,style:filled,shape:rect,fontcolor:black"
  },
  "class_map": {
    "Setup": "step",
    "ShowRules": "step",
    "UserConfirm": "step",
    "ApplyRules": "step",
    "Reload": "step",
    "Finish": "step"
  }
}
